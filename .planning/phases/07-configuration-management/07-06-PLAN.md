---
phase: 07-configuration-management
plan: 06
type: execute
wave: 2
depends_on: ["07-05"]
files_modified:
  - docs-site/content/de/docs/configuration.md
  - docs-site/content/es/docs/configuration.md
  - docs-site/content/ja/docs/configuration.md
  - docs-site/content/ko/docs/configuration.md
  - docs-site/content/zh-cn/docs/configuration.md
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "German documentation mentions TOML format support with tabs"
    - "Spanish documentation mentions TOML format support with tabs"
    - "Japanese documentation mentions TOML format support with tabs"
    - "Korean documentation mentions TOML format support with tabs"
    - "Chinese documentation mentions TOML format support with tabs"
    - "All translations have hot-reload section with actual implementation details"
  artifacts:
    - path: "docs-site/content/de/docs/configuration.md"
      provides: "German configuration docs with TOML and hot-reload"
      contains: ["TOML", ".toml", "tabs items", "fsnotify"]
    - path: "docs-site/content/es/docs/configuration.md"
      provides: "Spanish configuration docs with TOML and hot-reload"
      contains: ["TOML", ".toml", "tabs items", "fsnotify"]
    - path: "docs-site/content/ja/docs/configuration.md"
      provides: "Japanese configuration docs with TOML and hot-reload"
      contains: ["TOML", ".toml", "tabs items", "fsnotify"]
    - path: "docs-site/content/ko/docs/configuration.md"
      provides: "Korean configuration docs with TOML and hot-reload"
      contains: ["TOML", ".toml", "tabs items", "fsnotify"]
    - path: "docs-site/content/zh-cn/docs/configuration.md"
      provides: "Chinese configuration docs with TOML and hot-reload"
      contains: ["TOML", ".toml", "tabs items", "fsnotify"]
  key_links:
    - from: "docs-site/content/*/docs/configuration.md"
      to: "docs-site/content/en/docs/configuration.md"
      via: "translated content mirrors English structure"
      pattern: "TOML|fsnotify|tabs items"
---

<objective>
Translate configuration documentation updates from English to all 5 other supported languages: German (de), Spanish (es), Japanese (ja), Korean (ko), and Chinese (zh-cn).

Purpose: Close documentation gaps in translations where CONF-02 (TOML support) and CONF-05 (hot-reload) are not documented.

Output: All 5 translation files updated with:
- TOML format mentioned alongside YAML (translated)
- Tabbed examples showing both YAML and TOML (code unchanged, prose translated)
- Hot-reload section describing actual behavior (translated)
- File location docs including .toml extension
</objective>

<execution_context>
@/home/omarluq/.claude/get-shit-done/workflows/execute-plan.md
@/home/omarluq/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-configuration-management/07-05-SUMMARY.md

# Source for translations
@docs-site/content/en/docs/configuration.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update German (de) configuration documentation</name>
  <files>docs-site/content/de/docs/configuration.md</files>
  <action>
Apply the same structural changes from 07-05 to the German translation:

1. **Opening paragraph** (line ~6):
   Change: "CC-Relay wird ueber YAML-Dateien konfiguriert"
   To: "CC-Relay wird ueber YAML- oder TOML-Dateien konfiguriert"

2. **Configuration File Location section**:
   - Update file locations to include `.toml`:
     ```
     1. `./config.yaml` oder `./config.toml` (aktuelles Verzeichnis)
     2. `~/.config/cc-relay/config.yaml` oder `~/.config/cc-relay/config.toml`
     3. Pfad angegeben ueber `--config` Flag
     ```
   - Add: "Das Format wird automatisch anhand der Dateierweiterung erkannt (`.yaml`, `.yml` oder `.toml`)."

3. **Environment Variable Expansion** - Add tabs with German tab labels:
   ```
   {{< tabs items="YAML,TOML" >}}
   ```
   (Code examples remain unchanged, only prose is translated)

4. **Complete Configuration Reference** - Add tabs (code unchanged)

5. **Hot Reloading section** - Replace incorrect text with German translation:
   ```markdown
   ## Hot-Reloading

   CC-Relay erkennt und wendet Konfigurationsaenderungen automatisch an, ohne dass ein Neustart erforderlich ist. Dies ermoeglicht Konfigurationsaktualisierungen ohne Ausfallzeit.

   ### Funktionsweise

   CC-Relay verwendet [fsnotify](https://github.com/fsnotify/fsnotify) zur Ueberwachung der Konfigurationsdatei:

   1. **Dateiueberwachung**: Das uebergeordnete Verzeichnis wird ueberwacht, um atomare Schreibvorgaenge korrekt zu erkennen (Temp-Datei + Umbenennung, wie von den meisten Editoren verwendet)
   2. **Entprellung**: Mehrere schnelle Dateiereignisse werden mit einer 100ms Verzoegerung zusammengefasst
   3. **Atomarer Austausch**: Neue Konfiguration wird geladen und atomar mit Go's `sync/atomic.Pointer` ausgetauscht
   4. **Erhaltung laufender Anfragen**: Anfragen in Bearbeitung verwenden weiterhin die alte Konfiguration; neue Anfragen verwenden die aktualisierte Konfiguration

   ### Ereignisse, die ein Neuladen ausloesen

   | Ereignis | Loest Neuladen aus |
   |----------|-------------------|
   | Datei schreiben | Ja |
   | Datei erstellen (atomares Umbenennen) | Ja |
   | Datei chmod | Nein (ignoriert) |
   | Andere Datei im Verzeichnis | Nein (ignoriert) |

   ### Protokollierung

   Bei Hot-Reload sehen Sie Log-Nachrichten:

   ```
   INF config file reloaded path=/path/to/config.yaml
   INF config hot-reloaded successfully
   ```

   Bei ungueltiger Konfiguration:

   ```
   ERR failed to reload config path=/path/to/config.yaml error="validation error"
   ```

   Ungueltige Konfigurationen werden abgelehnt und der Proxy laeuft mit der vorherigen gueltigen Konfiguration weiter.

   ### Einschraenkungen

   - **Provider-Aenderungen**: Hinzufuegen oder Entfernen von Providern erfordert einen Neustart
   - **Listen-Adresse**: Aendern von `server.listen` erfordert einen Neustart
   - **gRPC-Adresse**: Aendern der gRPC-Management-API-Adresse erfordert einen Neustart

   Konfigurationsoptionen, die hot-reloadbar sind:
   - Logging-Level und Format
   - Rate-Limits fuer bestehende Schluessel
   - Health-Check-Intervalle
   - Routing-Strategie-Gewichtungen und Prioritaeten
   ```

6. **Example Configurations** - Add tabs to all 3 examples (code unchanged)
  </action>
  <verify>
   - grep -c "TOML\|\.toml" docs-site/content/de/docs/configuration.md returns > 10
   - grep -c "tabs items" docs-site/content/de/docs/configuration.md returns >= 4
   - grep -c "fsnotify" docs-site/content/de/docs/configuration.md returns >= 1
   - grep "zukuenftige Version geplant\|fuer eine zukuenftige Version" docs-site/content/de/docs/configuration.md returns empty
  </verify>
  <done>German documentation updated with TOML support and hot-reload</done>
</task>

<task type="auto">
  <name>Task 2: Update Spanish (es) configuration documentation</name>
  <files>docs-site/content/es/docs/configuration.md</files>
  <action>
Apply the same structural changes to Spanish translation:

1. **Opening paragraph**:
   Change: "CC-Relay se configura mediante archivos YAML"
   To: "CC-Relay se configura mediante archivos YAML o TOML"

2. **File locations** - Include `.toml`:
   ```
   1. `./config.yaml` o `./config.toml` (directorio actual)
   2. `~/.config/cc-relay/config.yaml` o `~/.config/cc-relay/config.toml`
   3. Ruta especificada via flag `--config`
   ```
   Add: "El formato se detecta automaticamente por la extension del archivo (`.yaml`, `.yml` o `.toml`)."

3. **Environment Variable Expansion** - Add tabs

4. **Complete Configuration Reference** - Add tabs

5. **Hot Reloading section** - Spanish translation:
   ```markdown
   ## Recarga en Caliente

   CC-Relay detecta y aplica automaticamente los cambios de configuracion sin requerir un reinicio. Esto permite actualizaciones de configuracion sin tiempo de inactividad.

   ### Como Funciona

   CC-Relay usa [fsnotify](https://github.com/fsnotify/fsnotify) para monitorear el archivo de configuracion:

   1. **Monitoreo de archivos**: Se monitorea el directorio padre para detectar correctamente las escrituras atomicas (archivo temporal + renombrado usado por la mayoria de editores)
   2. **Antirrebote**: Multiples eventos de archivo rapidos se agrupan con un retardo de 100ms
   3. **Intercambio atomico**: La nueva configuracion se carga e intercambia atomicamente usando `sync/atomic.Pointer` de Go
   4. **Preservacion de solicitudes en curso**: Las solicitudes en progreso continuan con la configuracion anterior; las nuevas solicitudes usan la configuracion actualizada

   ### Eventos que Disparan la Recarga

   | Evento | Dispara Recarga |
   |--------|-----------------|
   | Escritura de archivo | Si |
   | Creacion de archivo (renombrado atomico) | Si |
   | Chmod de archivo | No (ignorado) |
   | Otro archivo en el directorio | No (ignorado) |

   ### Registro

   Cuando ocurre una recarga en caliente, vera mensajes de registro:

   ```
   INF config file reloaded path=/path/to/config.yaml
   INF config hot-reloaded successfully
   ```

   Si la nueva configuracion es invalida:

   ```
   ERR failed to reload config path=/path/to/config.yaml error="validation error"
   ```

   Las configuraciones invalidas se rechazan y el proxy continua con la configuracion valida anterior.

   ### Limitaciones

   - **Cambios de provider**: Agregar o eliminar providers requiere reinicio
   - **Direccion de escucha**: Cambiar `server.listen` requiere reinicio
   - **Direccion gRPC**: Cambiar la direccion de la API de gestion gRPC requiere reinicio

   Opciones de configuracion que pueden recargarse en caliente:
   - Nivel y formato de registro
   - Limites de tasa en claves existentes
   - Intervalos de verificacion de salud
   - Pesos y prioridades de estrategia de enrutamiento
   ```

6. **Example Configurations** - Add tabs to all 3 examples
  </action>
  <verify>
   - grep -c "TOML\|\.toml" docs-site/content/es/docs/configuration.md returns > 10
   - grep -c "tabs items" docs-site/content/es/docs/configuration.md returns >= 4
   - grep -c "fsnotify" docs-site/content/es/docs/configuration.md returns >= 1
  </verify>
  <done>Spanish documentation updated with TOML support and hot-reload</done>
</task>

<task type="auto">
  <name>Task 3: Update Japanese (ja) configuration documentation</name>
  <files>docs-site/content/ja/docs/configuration.md</files>
  <action>
Apply the same structural changes to Japanese translation:

1. **Opening paragraph**:
   Change: "CC-Relay は YAML ファイルで設定されます"
   To: "CC-Relay は YAML または TOML ファイルで設定されます"

2. **File locations** - Include `.toml`:
   ```
   1. `./config.yaml` または `./config.toml`（カレントディレクトリ）
   2. `~/.config/cc-relay/config.yaml` または `~/.config/cc-relay/config.toml`
   3. `--config` フラグで指定されたパス
   ```
   Add: "フォーマットはファイル拡張子（`.yaml`、`.yml`、または `.toml`）から自動的に検出されます。"

3. **Environment Variable Expansion** - Add tabs

4. **Complete Configuration Reference** - Add tabs

5. **Hot Reloading section** - Japanese translation:
   ```markdown
   ## ホットリロード

   CC-Relay は設定変更を自動的に検出して適用し、再起動を必要としません。これによりダウンタイムなしで設定を更新できます。

   ### 動作の仕組み

   CC-Relay は [fsnotify](https://github.com/fsnotify/fsnotify) を使用して設定ファイルを監視します：

   1. **ファイル監視**: 親ディレクトリを監視し、アトミック書き込み（ほとんどのエディタが使用する一時ファイル + リネームパターン）を正しく検出
   2. **デバウンス**: 複数の高速ファイルイベントは100msの遅延で集約
   3. **アトミックスワップ**: 新しい設定はGoの `sync/atomic.Pointer` を使用してアトミックにロードおよびスワップ
   4. **処理中リクエストの保持**: 処理中のリクエストは古い設定を継続使用、新しいリクエストは更新された設定を使用

   ### リロードをトリガーするイベント

   | イベント | リロードをトリガー |
   |---------|------------------|
   | ファイル書き込み | はい |
   | ファイル作成（アトミックリネーム） | はい |
   | ファイル chmod | いいえ（無視） |
   | ディレクトリ内の他のファイル | いいえ（無視） |

   ### ログ出力

   ホットリロード時には、ログメッセージが表示されます：

   ```
   INF config file reloaded path=/path/to/config.yaml
   INF config hot-reloaded successfully
   ```

   新しい設定が無効な場合：

   ```
   ERR failed to reload config path=/path/to/config.yaml error="validation error"
   ```

   無効な設定は拒否され、プロキシは以前の有効な設定で継続動作します。

   ### 制限事項

   - **プロバイダーの変更**: プロバイダーの追加または削除には再起動が必要
   - **リッスンアドレス**: `server.listen` の変更には再起動が必要
   - **gRPCアドレス**: gRPC管理APIアドレスの変更には再起動が必要

   ホットリロード可能な設定オプション：
   - ログレベルとフォーマット
   - 既存キーのレート制限
   - ヘルスチェック間隔
   - ルーティング戦略の重みと優先度
   ```

6. **Example Configurations** - Add tabs to all 3 examples
  </action>
  <verify>
   - grep -c "TOML\|\.toml" docs-site/content/ja/docs/configuration.md returns > 10
   - grep -c "tabs items" docs-site/content/ja/docs/configuration.md returns >= 4
   - grep -c "fsnotify" docs-site/content/ja/docs/configuration.md returns >= 1
  </verify>
  <done>Japanese documentation updated with TOML support and hot-reload</done>
</task>

<task type="auto">
  <name>Task 4: Update Korean (ko) configuration documentation</name>
  <files>docs-site/content/ko/docs/configuration.md</files>
  <action>
Apply the same structural changes to Korean translation:

1. **Opening paragraph**:
   Change: "CC-Relay는 YAML 파일로 설정됩니다"
   To: "CC-Relay는 YAML 또는 TOML 파일로 설정됩니다"

2. **File locations** - Include `.toml`:
   ```
   1. `./config.yaml` 또는 `./config.toml` (현재 디렉토리)
   2. `~/.config/cc-relay/config.yaml` 또는 `~/.config/cc-relay/config.toml`
   3. `--config` 플래그로 지정된 경로
   ```
   Add: "파일 확장자(`.yaml`, `.yml` 또는 `.toml`)에서 형식이 자동으로 감지됩니다."

3. **Environment Variable Expansion** - Add tabs

4. **Complete Configuration Reference** - Add tabs

5. **Hot Reloading section** - Korean translation:
   ```markdown
   ## 핫 리로드

   CC-Relay는 재시작 없이 설정 변경을 자동으로 감지하고 적용합니다. 이를 통해 다운타임 없이 설정을 업데이트할 수 있습니다.

   ### 작동 방식

   CC-Relay는 [fsnotify](https://github.com/fsnotify/fsnotify)를 사용하여 설정 파일을 모니터링합니다:

   1. **파일 모니터링**: 상위 디렉토리를 모니터링하여 원자적 쓰기(대부분의 편집기에서 사용하는 임시 파일 + 이름 변경 패턴)를 올바르게 감지
   2. **디바운싱**: 여러 빠른 파일 이벤트는 100ms 지연으로 통합
   3. **원자적 스왑**: 새 설정은 Go의 `sync/atomic.Pointer`를 사용하여 원자적으로 로드 및 스왑
   4. **진행 중인 요청 보존**: 진행 중인 요청은 이전 설정을 계속 사용하고, 새 요청은 업데이트된 설정을 사용

   ### 리로드를 트리거하는 이벤트

   | 이벤트 | 리로드 트리거 |
   |--------|--------------|
   | 파일 쓰기 | 예 |
   | 파일 생성 (원자적 이름 변경) | 예 |
   | 파일 chmod | 아니오 (무시) |
   | 디렉토리 내 다른 파일 | 아니오 (무시) |

   ### 로깅

   핫 리로드 발생 시 로그 메시지가 표시됩니다:

   ```
   INF config file reloaded path=/path/to/config.yaml
   INF config hot-reloaded successfully
   ```

   새 설정이 유효하지 않은 경우:

   ```
   ERR failed to reload config path=/path/to/config.yaml error="validation error"
   ```

   유효하지 않은 설정은 거부되고 프록시는 이전의 유효한 설정으로 계속 실행됩니다.

   ### 제한 사항

   - **프로바이더 변경**: 프로바이더 추가 또는 제거는 재시작 필요
   - **리슨 주소**: `server.listen` 변경은 재시작 필요
   - **gRPC 주소**: gRPC 관리 API 주소 변경은 재시작 필요

   핫 리로드 가능한 설정 옵션:
   - 로그 레벨 및 형식
   - 기존 키의 속도 제한
   - 헬스 체크 간격
   - 라우팅 전략 가중치 및 우선순위
   ```

6. **Example Configurations** - Add tabs to all 3 examples
  </action>
  <verify>
   - grep -c "TOML\|\.toml" docs-site/content/ko/docs/configuration.md returns > 10
   - grep -c "tabs items" docs-site/content/ko/docs/configuration.md returns >= 4
   - grep -c "fsnotify" docs-site/content/ko/docs/configuration.md returns >= 1
  </verify>
  <done>Korean documentation updated with TOML support and hot-reload</done>
</task>

<task type="auto">
  <name>Task 5: Update Chinese (zh-cn) configuration documentation</name>
  <files>docs-site/content/zh-cn/docs/configuration.md</files>
  <action>
Apply the same structural changes to Chinese translation:

1. **Opening paragraph**:
   Change: "CC-Relay 通过 YAML 文件进行配置"
   To: "CC-Relay 通过 YAML 或 TOML 文件进行配置"

2. **File locations** - Include `.toml`:
   ```
   1. `./config.yaml` 或 `./config.toml`（当前目录）
   2. `~/.config/cc-relay/config.yaml` 或 `~/.config/cc-relay/config.toml`
   3. 通过 `--config` 标志指定的路径
   ```
   Add: "文件格式根据扩展名（`.yaml`、`.yml` 或 `.toml`）自动检测。"

3. **Environment Variable Expansion** - Add tabs

4. **Complete Configuration Reference** - Add tabs

5. **Hot Reloading section** - Chinese translation:
   ```markdown
   ## 热重载

   CC-Relay 自动检测并应用配置更改，无需重启。这使得可以在零停机时间内更新配置。

   ### 工作原理

   CC-Relay 使用 [fsnotify](https://github.com/fsnotify/fsnotify) 监控配置文件：

   1. **文件监控**：监控父目录以正确检测原子写入（大多数编辑器使用的临时文件+重命名模式）
   2. **防抖动**：多个快速文件事件会以100毫秒延迟合并
   3. **原子交换**：新配置使用 Go 的 `sync/atomic.Pointer` 原子加载和交换
   4. **保留进行中的请求**：正在处理的请求继续使用旧配置；新请求使用更新的配置

   ### 触发重载的事件

   | 事件 | 触发重载 |
   |------|---------|
   | 文件写入 | 是 |
   | 文件创建（原子重命名） | 是 |
   | 文件 chmod | 否（忽略） |
   | 目录中的其他文件 | 否（忽略） |

   ### 日志记录

   热重载发生时，您将看到日志消息：

   ```
   INF config file reloaded path=/path/to/config.yaml
   INF config hot-reloaded successfully
   ```

   如果新配置无效：

   ```
   ERR failed to reload config path=/path/to/config.yaml error="validation error"
   ```

   无效的配置会被拒绝，代理将继续使用之前的有效配置运行。

   ### 限制

   - **提供者更改**：添加或删除提供者需要重启
   - **监听地址**：更改 `server.listen` 需要重启
   - **gRPC 地址**：更改 gRPC 管理 API 地址需要重启

   可以热重载的配置选项：
   - 日志级别和格式
   - 现有密钥的速率限制
   - 健康检查间隔
   - 路由策略权重和优先级
   ```

6. **Example Configurations** - Add tabs to all 3 examples
  </action>
  <verify>
   - grep -c "TOML\|\.toml" docs-site/content/zh-cn/docs/configuration.md returns > 10
   - grep -c "tabs items" docs-site/content/zh-cn/docs/configuration.md returns >= 4
   - grep -c "fsnotify" docs-site/content/zh-cn/docs/configuration.md returns >= 1
  </verify>
  <done>Chinese documentation updated with TOML support and hot-reload</done>
</task>

</tasks>

<verification>
After completing all tasks:

1. Build Hugo site to verify no shortcode errors in any language:
   ```bash
   cd docs-site && hugo --minify 2>&1 | grep -i error || echo "No errors"
   ```

2. Verify all languages have TOML documented:
   ```bash
   for lang in de es ja ko zh-cn; do
     echo "$lang: $(grep -c 'TOML' docs-site/content/$lang/docs/configuration.md)"
   done
   # Each should be > 5
   ```

3. Verify all languages have tabs:
   ```bash
   for lang in de es ja ko zh-cn; do
     echo "$lang tabs: $(grep -c '{{< tabs items' docs-site/content/$lang/docs/configuration.md)"
   done
   # Each should be >= 4
   ```

4. Verify hot-reload is documented in all languages:
   ```bash
   for lang in de es ja ko zh-cn; do
     echo "$lang fsnotify: $(grep -c 'fsnotify' docs-site/content/$lang/docs/configuration.md)"
   done
   # Each should be >= 1
   ```
</verification>

<success_criteria>
1. All 5 translations mention TOML support in opening paragraph
2. All 5 translations have file locations with .toml extensions
3. All 5 translations have at least 4 tabbed YAML/TOML examples
4. All 5 translations have hot-reload section with fsnotify, debounce, atomic swap
5. No "planned for future release" text remains in any translation
6. Hugo builds without shortcode errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-configuration-management/07-06-SUMMARY.md`
</output>
