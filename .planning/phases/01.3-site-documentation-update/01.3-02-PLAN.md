---
phase: 01.3-site-documentation-update
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - docs-site/content/en/docs/configuration.md
autonomous: true

must_haves:
  truths:
    - "Configuration.md includes cache configuration section"
    - "Cache mode selection documented (single, ha, disabled)"
    - "Ristretto configuration options documented"
    - "Olric configuration options documented (embedded and client mode)"
    - "Example cache configurations included"
  artifacts:
    - path: "docs-site/content/en/docs/configuration.md"
      provides: "English configuration documentation with cache section"
      contains: "## Cache Configuration"
  key_links:
    - from: "docs-site/content/en/docs/configuration.md"
      to: "docs/cache.md"
      via: "configuration reference"
      pattern: "cache:"
---

<objective>
Add cache configuration section to English configuration.md

Purpose: The configuration.md page covers server, provider, and logging configuration but is missing cache configuration entirely. Users need to know how to configure caching as part of the main configuration reference.

Output: Updated docs-site/content/en/docs/configuration.md with Cache Configuration section
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01.3-site-documentation-update/01.3-RESEARCH.md
@docs/cache.md
@docs-site/content/en/docs/configuration.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Cache Configuration section to configuration.md</name>
  <files>docs-site/content/en/docs/configuration.md</files>
  <action>
Add a new "## Cache Configuration" section after the existing "## Logging Configuration" section (before "## Example Configurations"). Include:

1. **Cache Modes** overview table:
   | Mode | Backend | Description |
   |------|---------|-------------|
   | `single` | Ristretto | High-performance local in-memory cache (default) |
   | `ha` | Olric | Distributed cache for high-availability deployments |
   | `disabled` | Noop | Passthrough mode with no caching |

2. **Single Mode (Ristretto)** subsection:
   ```yaml
   cache:
     mode: single
     ristretto:
       num_counters: 1000000  # 10x expected max items
       max_cost: 104857600    # 100 MB
       buffer_items: 64       # Admission buffer size
   ```

   Brief explanation of each option:
   - num_counters: Number of 4-bit access counters (recommended: 10x expected max items)
   - max_cost: Maximum memory in bytes
   - buffer_items: Controls admission buffer size

3. **HA Mode (Olric) - Embedded** subsection:
   ```yaml
   cache:
     mode: ha
     olric:
       embedded: true
       bind_addr: "0.0.0.0:3320"
       dmap_name: "cc-relay"
       environment: lan
       peers:
         - "other-node:3322"  # memberlist port = bind_addr + 2
       replica_count: 2
       read_quorum: 1
       write_quorum: 1
       member_count_quorum: 2
       leave_timeout: 5s
   ```

   Brief explanation of key options:
   - embedded: Run embedded Olric node vs connect to external cluster
   - bind_addr: Address for Olric connections (memberlist uses port + 2)
   - environment: "local", "lan", or "wan" presets
   - peers: Other nodes' memberlist addresses for discovery
   - replica_count, read_quorum, write_quorum: Consistency settings

4. **HA Mode (Olric) - Client Mode** subsection:
   ```yaml
   cache:
     mode: ha
     olric:
       addresses:
         - "olric-1:3320"
         - "olric-2:3320"
       dmap_name: "cc-relay"
   ```

   Explain this connects to an external Olric cluster.

5. **Disabled Mode** subsection:
   ```yaml
   cache:
     mode: disabled
   ```

   Note that all cache operations return immediately without storing.

Add cross-reference to detailed caching documentation:
"For comprehensive caching documentation including HA clustering guide and troubleshooting, see [Caching](/docs/caching/)."
  </action>
  <verify>
Run `hugo --source docs-site` to verify the documentation builds without errors.
Grep for "## Cache Configuration" in the file.
  </verify>
  <done>
English configuration.md contains Cache Configuration section with all modes documented and cross-reference to caching docs.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update Complete Configuration Reference with cache section</name>
  <files>docs-site/content/en/docs/configuration.md</files>
  <action>
Update the "## Complete Configuration Reference" YAML block near the top of the file to include the cache configuration section. Add after the logging section:

```yaml
# ==========================================================================
# Cache Configuration
# ==========================================================================
cache:
  # Cache mode: single, ha, disabled
  mode: single

  # Single mode configuration (Ristretto)
  ristretto:
    num_counters: 1000000
    max_cost: 104857600
    buffer_items: 64

  # HA mode configuration (Olric)
  olric:
    embedded: true
    bind_addr: "0.0.0.0:3320"
    dmap_name: "cc-relay"
    environment: lan
    peers: []
    replica_count: 1
    read_quorum: 1
    write_quorum: 1
    member_count_quorum: 1
    leave_timeout: 5s
```

This ensures the complete reference block shows all configuration options including cache.
  </action>
  <verify>
Grep for "# Cache Configuration" in the Complete Configuration Reference section.
  </verify>
  <done>
Complete Configuration Reference includes cache section with all options.
  </done>
</task>

</tasks>

<verification>
1. Hugo builds successfully: `hugo --source docs-site`
2. configuration.md has Cache Configuration section
3. Complete Configuration Reference includes cache block
4. Cross-reference to caching page exists
</verification>

<success_criteria>
- docs-site/content/en/docs/configuration.md contains Cache Configuration section
- All three cache modes documented with examples
- Complete Configuration Reference includes cache section
- Documentation site builds without errors
</success_criteria>

<output>
After completion, create `.planning/phases/01.3-site-documentation-update/01.3-02-SUMMARY.md`
</output>
